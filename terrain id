As discussed previously, the Cyber Protection Team (CPT) Operations Process (OP) includes six steps. The second step is Terrain Identification and Prioritization, which details the mission objective as it relates to the initial goals, final outcomes, and instructions provided by the commander. Terrain Identification is comprised of identifying and analyzing Key Terrain in Cyberspace (KT-C) including logical and physical components, analyzing terrain maps, and developing terrain maps to identify KT-C. 

This lesson details identifying terrain in addition to current Operating Environment (OE) conditions, circumstances, and influences that guide decision-making in support of Defensive Cyberspace Operations (DCO). 
4.2.1: IDENTIFY KT-C4.2.2: ANALYZE terrain maps/KT-C4.2.3: DEVELOP terrain maps to identify KT-C

Terrain, which covers all of cyberspace, includes the logical and physical components. When defining terrain DCO team members should use KT-C, Mission Relevant Terrain in Cyberspace (MRT-C), Task Critical Asset (TCA), and Defense Critical Asset (DCA) as outlined in United States Cyber Command (USCC) Operational Guidance on Identification of Mission Relevant Terrain in Cyberspace.  
KT-C: Any locality or area — physical or logical — where seizure, retention, or other specified degrees of control provide a marked advantage in cyberspace to any combatant.  MRT-C: Described as — but not limited to — all devices, internal/external links, Operating Systems (OS), services, applications, ports, protocols, hardware, and software on servers required to enable the function of a critical asset.  TCA: An asset that is of such extraordinary importance that its incapacitation or destruction would have a serious, debilitating effect on the ability of one or more Department of Defense (DoD) or Office of the Secretary of Defense (OSD) components to execute the capability or mission-essential task it supports. TCAs are used to identify DCAs.  DCA: An asset of such extraordinary importance to operations in peace, crisis, and war that its incapacitation or destruction would have a very serious, debilitating effect on the ability of the DoD to fulfill its missions.  
Identifying terrain has a direct impact on a CPT’s mission. Once the CPT has an assigned terrain in which to hunt and operate, the threat hunter can filter through the terrain, based on the types of systems and data available. Data requirements are tied to analytics that are then tied to Tactics, Techniques, and Procedures (TTP) used. Identifying terrain, in turn, reduces the number of analytics necessary for the team to execute. The threat hunter can also filter through the terrain on the identified MRT-C and KT-C to prioritize the required data collection.

What is best described as any locality or area — physical or logical — where seizure, retention, or other specified degree of control provides a marked advantage in cyberspace to any combatant?
KT-C

Terrain Analysis and Identification

Terrain analysis is the collection, analysis, evaluation, and interpretation of geographic (physical) and digital (virtual) information on the natural and man-made features of the terrain — combined with other relevant factors — to predict the effect of the terrain on military operations. Within DCO, it involves the study and interpretation of features of the terrain and their effects on military operations. 

﻿

Terrain Analysis and Site Survey  
﻿
A site survey is the examination of a location in order to obtain data or information. The information obtained during a site survey helps determine the mission terrain, gathers critical data, and defines the network owner’s needs. Information that can be collected during a site survey includes access to the site and necessary equipment, network topology, OSs, and critical on-site personnel to assist with the operation (such as security and information technology personnel).  During the site survey, a DCO team supporting threat hunting develops relationships with the network owner, finalizes the Operation Order (OPORD), develops the tactical plan, and collects the crucial mission data necessary to build a hunt plan. 


The site survey allows for time to come to an agreement with the network owner and Operational Control (OPCON) chain in regards to tactical plan execution. It is during this time that a team arrives, requests a work location, gains access to personnel/systems, and integrates its equipment and tools into the network.  

﻿
Though site surveys may not be required for each operation (for example, if the mission is returning to a previously visited site), when conducted, a site survey should be at the network administrator or local defender's location of the designated terrain.

To develop the fundamental understanding of the terrain, a DCO team must collect data before the site survey occurs. Data to collect prior to the site survey includes policy documents, briefings, log samples, network maps, or vulnerability scans. The data collection needed is mission- and team-dependent and may need authority to connect and operate on the terrain, user or administrator accounts, or other support. These should be pre-coordinated with the OPCON chain and the network owner before the on-site portion of the survey. Collaborate with the assigned DCO team to obtain the latest site survey. Discuss fundamentals of the network with the DCO team personnel and local defenders to identify all relevant information about the network.

The site survey provides time that is used to gain the agreement with the network owner and OPCON chain in regards to tactical plan execution.
true
Terrain-based Cyberspace Threat Hunting Methodologies

Cyberspace Threat Hunting (CTH) is the process of proactively and iteratively searching through networks to detect and isolate advanced threats that evade existing security solutions. To best conduct DCO, opportunities exist for CTH at all tiers of networks. There are three unique core CTH methodologies driven by analytics, situational awareness, and intelligence.﻿

Analytics — Driven
﻿
Analytics — Driven methodology leverages data and analytics. This methodology utilizes complex queries and algorithms to apply to data sets. Often the queries are applied utilizing automation in software. A key distinction with the Analytics methodology is no physical access to local machines, networks, or systems is required. Data artifacts consisting of sensor alerts, system logs, and network traffic are vital to the Analytics — Driven Methodology. CTH analysts combine knowledge of data artifacts with knowledge of automated analysis capabilities to develop a picture of the network terrain.

Situational Awareness — Driven 
﻿
Situational Awareness — Driven methodology leverages an advanced understanding of a particular cyberspace terrain in order to detect anomalous activity. Much like Analytics, Situational Awareness does not require physical access to local systems. Data artifacts pertaining to the operating environment are critical to this methodology. CTH analysts examine data artifacts over time in order to understand system normality and detect outliers in behavior, which often lead to discovering potentially Malicious Cyberspace Activity (MCA).

Intelligence — Driven
﻿
Intelligence — Driven methodology leverages timely, accurate, mature Cyberspace Threat Intelligence (CTI) to detect advanced cyberspace threats. Intelligence — Driven methodology requires physical access to local systems. 

Which best describes a Situational Awareness — Driven CTH methodology?
leverages an advanced unerstanding of a particular cyberspace terrain in order to detect anomalous activit, which coud implicate advanced cyberspace threats

Defining an Operational Environment
An OE is a composite of the conditions, circumstances, and influences that affect the employment of capabilities and bear on the decisions of the commander. Components including the type of equipment, the size of the network, OSs, key personnel, and schedule of the location all play critical roles in decision making. These components help to define the OE. 

﻿

Defining the OE results in the identification of:  

Significant characteristics that can affect friendly and threat operations
Gaps in current intelligence
CTH analysts identify significant relevant characteristics related to the mission variables of the enemy and terrain. The threat operator evaluates significant characteristics to identify gaps and initiate information collection. Failure to identify or misidentify the effect these variables may have on the mission at a given time and place can hinder decision-making and result in mission failure.  

﻿

The sum of the characteristics identified represents the current OE. Defining the OE in an operation is the foundation that enables mission decision-making and guides strategy.

Layers of Cyberspace
When defining the OE, start with the three layers of cyberspace:

Physical network 
Logical network
Cyber-Persona
When evaluating the OE for a DCO mission, collaboration with the local network owner is essential.

Physical Network Layer  
﻿
The physical network layer consists of the tactile Information Technology (IT) devices and infrastructure in the domains that provide storage, transport, and processing of information within cyberspace. The layer includes data repositories and the connections that transfer data between network components. Physical network components include the hardware and infrastructure (e.g., computing devices, storage devices, network devices, and wired and wireless links). These components require physical security measures to protect them from damage or unauthorized access, which may be leveraged to gain logical access. 

Depicting the physical network layer within the OE allows analysts to inspect the layer as it relates to friendly and threat operations. CTH analysts derive the physical network layer depiction from products developed by the network owner and through their own validation of the network. 

When analyzing the physical network layer, identify:

Threat Command and Control (C2) systems  — physical devices adversaries use to leverage to execute their operations — that traverse the cyberspace domain
Critical nodes the threat can use as hop points in the OE
Physical network devices in the terrain (e.g., fiber optic cables, internet exchanges, and public access points)
Elements or entities — threat and non-threat — interested in and possessing the ability to access data and information residing on and moving through the network
Physical storage locations with the most critical information and accessibility to that information
Implemented measures that prevent threat actors from accessing the networks



Logical Network Layer**
The logical network layer consists of all the data — whether resting, moving, or being used in the physical network layer. The logical network layer is based on the programming or software that drives network communications, interactions, and connectivity. Individual links and nodes are represented in the logical network layer along with various distributed elements of cyberspace including data, applications, and network processes not tied to a single node. 

Network maps often depict the logical network layer in relation to the physical network layer. Reporting from many sources can provide information about the logical network layer of threat cyberspace, including — but not limited to — protocols, Internet Protocol (IP) address blocks, and OSs. Network key systems can be assessed using the depiction on the logical network layer. 

When analyzing the logical network layer, identify:  

Websites or web pages that influence or have a social impact on the network
Friendly logical network configurations and vulnerabilities and the friendly physical network configurations
Software that handles and shares friendly data
Virtual Private Networks (VPN) or subnets that cross physical boundaries


Cyber-Persona Layer
The cyber-persona layer is a view of cyberspace created by pulling artifacts and data from the logical network layer to describe actors and entities that utilize the network. The cyber-persona layer consists of network or IT user accounts, whether human or automated, and their relationships to one another. Cyber-personas may relate directly to an actual person or entity, incorporating some personal or organizational data (e.g., email and IP addresses, web pages, phone numbers, web forum logins, or financial account passwords).  

The cyber persona layer includes employee permissions to access physical and logical aspects of the OE. For instance, domain administrators have permission to configure and modify accounts on the Domain Controller (DC). Additionally, network engineers have permission to configure and modify the firewalls and network devices used to protect and regulate communication. 

When analyzing the cyber-persona layer, identify: 

Data and information consumers in the terrain
How local users interrelate with the physical network and logical network layers
Usernames, permission levels, email addresses, chat names, etc.


 details a sample terrain map. The terrain map includes critical nodes and access points for the Fort Drum Office network. The Fort Drum Office is the front office to Fort Drum. The office provides administrative and information technology (IT) support to Higher HQ. The terrain map provides an overview of the subnets, clients, servers, and network devices. 

To start the analysis of the Fort Drum Office terrain, identify who connects to the network and where the network itself connects. First, look at the top portion of the terrain map:

The Fort Drum Office network is connected via a gateway — gw-fw (labeled 1 in Figure 4.2-5) — to a cloud infrastructure. The cloud infrastructure is denoted by a cloud shape. The cloud offers three connection points, represented by three routers as shown in Figure 4.2-6: 

The cloud infrastructure acts as a storage and transport location for data. The data is moving to and from three distinct entities. The first entity includes the three remote workers, designated by the computer and house logo. The second entity is the Fort Drum Office. The Fort Drum Office acts as a front office for the large Fort Drum Enterprise. The third entity is Higher Headquarters (HQ). Higher HQ is where commanders operate and large, enterprise-wide decisions are made. Higher HQ maintains large amounts of sensitive data. 

Additional connections in this network are through two VPNs. As shown in Figure 4.2-7, remote workers are able to access the Fort Drum Office network remotely via a VPN — circled in red. Additionally, the Fort Drum Office is able to access Higher HQ network remotely via VPN. 
The second items to identify are the subnets. Subnets are networks embedded in the enterprise network. Typically, subnets are smaller than the enterprise network and are created to make networks operate more efficiently. The subnets in the Fort Drum Office network are circled in red in Figure 4.2-9:

breaks down all the components of each subnet. While the Demilitarized Zone (DMZ) is part of the network, it provides a more specialized function that is covered in the next task.

Fort Drum Office DMZ
A DMZ is a perimeter network that protects an organization's internal Local Area Network (LAN). The DMZ protects the enterprise network by offering a layer of separation between internet-facing services and more sensitive internal-only subnets. The Fort Drum Office’s DMZ is outlined in green in Figure 4.2-10: 

The DMZ devices consist of:
A web server
A Domain Name System (DNS) server 
A VPN server
Additionally, the DMZ utilizes Dynamic Host Configuration Protocol (DHCP) via Internet Service Provider (ISP). While this concept is covered in detail later in the course, DHCP via ISP is when a DHCP server assigns IPs by modem Media Access Control (MAC) address. When the modem is powered on, it communicates to the network indicating it is looking for an IP address. The DHCP server listens to this communication and starts talking to the modem. The modem then transmits its MAC address to the server. At that point, either an IP has been reserved for the modem or one is assigned at that time. 

Identifying Key Terrain
Key Terrain
﻿
Key terrain associated with cyberspace can be considered a physical node or data that is essential for mission accomplishment. Examples include major lines of communications, key waypoints for observing incoming threats, domain name services, network OSs, switches, spectrum-dependent devices (such as sensors), main ISP inputs, and mission-critical parts of the threat information network. Determining key terrain in cyberspace can be achieved by overlapping the threat’s critical asset list, mission, and intent. 
﻿
Domain Controllers 
﻿
The Fort Drum Office terrain is a Windows domain network, utilizing Active Directory (AD). AD is a database and set of services that connect users with the network. The DC is the terminal that controls AD. The DC manages many of the services running on the network, tracks which users are active/inactive on the network, and controls access to critical information. The DC is the most critical portion of this network. The Fort Drum Office terrain contains two DCs — a primary and a backup. Both of these terminals are key assets in the terrain. 

Below are resources to review how adversaries may attempt to gain access to and leverage the use of a DC:

﻿ https://attack.mitre.org/techniques/T1098/ ﻿   ﻿
https://attack.mitre.org/techniques/T1207/ 
h ttps://attack.mitre.org/techniques/T1078/0 0 2/   
﻿
ACAS Server
﻿
ACAS is a suite of security software responsible for assessing the network and determining if it meets the defined security objectives. ACAS utilizes Nessus to scan software to identify vulnerabilities and weak spots on the network. Nessus actively scans the network in an effort to detect defined vulnerabilities. ACAS also uses the Passive Vulnerability Scanner (PVS) to monitor network traffic at the packet level. PVS discovers new hosts added to a network, identifies ports that are passing traffic, and identifies when applications might be compromised. Administrators on the network are able to view the output from the ACAS server in a centralized software called Security Center (SC). Within SC, administrators make necessary adjustments and modifications to the ACAS and the network. The goal of the ACAS server is ultimately to make the environment as secure as possible. The Fort Drum Office terrain contains an ACAS server — a key asset in the terrain. The ACAS server holds information on potential vulnerabilities that exist in the network, and is, therefore, a good target for adversaries. 

Below are resources to review how adversaries may attempt to gain access to and leverage vulnerabilities persisting in a given terrain:
﻿ https://attack.mitre.org/techniques/T1595/002/  
﻿ https://attack.mitre.org/techniques/T1046/  
﻿ https://attack.mitre.org/techniques/T1423/  

VPN Server
﻿
The VPN server acts as a secure tunnel connecting two networks. For the Fort Drum Office, the VPN server allows connections between the Fort Drum Office and the Higher HQ network. If an adversary infiltrates the Fort Drum Office terrain and is able to gain access to the VPN Server, they could potentially leverage the server to move within the terrain and access Higher HQ. The Fort Drum Office terrain contains a VPN server — a key asset in the terrain. 

Below are resources to review how adversaries may attempt to gain access to and leverage VPN services in a given terrain:
﻿ https://attack.mitre.org/techniques/T1428/  
﻿ https://attack.mitre.org/techniques/T1133/  
Additional Resources:
Each of the following techniques is from the MITRE Adversarial Tactics, Techniques, and Common Knowledge (ATT&CK) framework.
DCs
Account Manipulation — T1098:  https://attack.mitre.org/techniques/T1098/   
Rogue Domain Controller — T1207:  https://attack.mitre.org/techniques/T1207/  
Valid Accounts: Domain Accounts — T1078.002:  https://attack.mitre.org/techniques/T1078/002/  
ACAS Server
Active Scanning: Vulnerability Scanning — T1595.002:  https://attack.mitre.org/techniques/T1595/002/  
Network Service Scanning — T1046:  https://attack.mitre.org/techniques/T1046/  
Network Service Scanning — T1423:  https://attack.mitre.org/techniques/T1423/  
VPN Server
Exploit Enterprise Resources — T1428:  https://attack.mitre.org/techniques/T1428/   
External Remote Services — T1133:  https://attack.mitre.org/techniques/T1133/  
﻿
Analyzing a Terrain Map
﻿
displays the Cyber Defense Analyst - Basic (CDA-B) terrain map. The CDA-B terrain is a relatively small corporate enterprise network. The terrain includes corporate departments: Accounting, Executive, and Human Resources (HR). The terrain also includes some supporting functions: DMZ, servers, and security — all of which are located behind their own respective firewalls. The supporting functions include AD services, domain name services, and Security Onion. 

NOTE: Security Onion is a free and open-source platform for threat hunting, network security monitoring, and log management. Security Onion includes best-of-breed open-source tools such as Suricata, Zeek, Wazuh, the Elastic Stack, and others. Security Onion will be introduced and utilized later in this course. 
The most critical service in the servers subnet is the DC (cda-dc). 

﻿Developing a Terrain Map
In this task, develop a terrain map based on the information provided to your CPT by the mission customer.

﻿

Network Brief
1 Palo Alto PA-3200 firewall
1 Juniper NX 5 router 
Provides routing to a WAP, a switch, and a file server
Supports three subnets:
Analyst subnet: 10.10.1.0/24
Server subnet: 10.10.2.0/24
Management subnet: 10.10.3.0/24
1 file server 
Name: file1
Static IP address: 10.10.2.10
Accessed by Analyst and Management Subnets for file storage and retrieval 
Contains all files shared in the network 
1 NETGEAR WAC104 WAP providing wireless access to the Analyst subnet:
6 HP Windows 10 laptops
10 Dell Windows 10 laptops
2 HP MFP
16 iPhoneX smartphones
1 Juniper EX440 switch providing connections to the Management subnet:
3 HP Windows 7 Personal Computers (PC)
5 Dell Windows 7 Personal Computers (PC)
6 Cisco 8000 Voice over IP (VoIP) phones
2 Avaya J100 Voice over IP (VoIP) phones
Permissions:
Two management accounts with administrator-level access 
Access is used to configure network devices (firewall, switch, and WAP)
Analyst and Management users do not have access to each others subnets
Other Notes:
Slack: Office’s internal messaging service application is housed in the file server
Contains data regarding users' names and messages
No VPN is utilized from the Analyst subnet 
The subnet contains wireless devices that may be used remotely
Firewall is the only network defense device for network






















